import{aB as $,_ as q,p as z,j as S,f as u,aU as _,C as T,g as w,h as M,c as l,o,d as s,t,e as P,ai as A,a0 as C,a9 as F,a as W,x as X,y as j,z as G,ad as O,aj as H,G as R,b as J,a6 as K}from"./appInit-CGHXFw0-.js";import{I as Q}from"./IconAlertCircle-Djjt2Tda.js";import"./index-sC8Xq0xY.js";function Y(){return $({url:"/user/comm/config",method:"get"})}function Z(h){return $({url:"/user/order/save",method:"post",data:{period:"deposit",deposit_amount:h,plan_id:0}})}const x={class:"deposit-container"},ee={class:"deposit-inner"},se={class:"dashboard-card welcome-card"},te={class:"card-header"},oe={class:"card-title"},ae={class:"card-body"},ne={class:"dashboard-card balance-card"},le={class:"card-header"},re={class:"card-title"},ie={class:"card-body"},ce={key:0,class:"balance-display"},de={class:"balance-value"},ue={class:"balance-label"},pe={key:1,class:"balance-skeleton"},me={class:"dashboard-card deposit-card"},ve={class:"card-header"},_e={class:"card-title"},he={class:"card-body"},fe={class:"deposit-notice"},be={class:"amount-selection"},ye={class:"period-cards"},ge=["onClick"],ke={class:"period-card-inner"},we={class:"period-price"},Ae={class:"currency"},Ce={class:"amount"},Fe={class:"custom-amount"},$e={for:"customAmount"},Ie={key:0,class:"input-container skeleton-input"},De={key:1,class:"input-container"},Ee={class:"currency-symbol"},Be=["placeholder"],Ne={key:2,class:"error-message"},Ue={class:"deposit-actions"},Ve={key:0,class:"btn-order-skeleton"},Le=["disabled"],qe={key:1,class:"loader"},ze={__name:"WalletDeposit",setup(h){const{t:a}=z(),{showToast:m}=R(),f=S();O()||f.push("/dashboard");const b=u(0),v=u("$"),I=u(_.presetAmounts||[6,30,68,128,256,328,648,1280]),p=u(_.defaultSelectedAmount||null),c=u(""),d=u(""),y=_.minimumDepositAmount||1,r=T({balance:!0,submitting:!1,config:!0}),D=async()=>{try{const e=await Y();e&&e.data&&e.data.currency_symbol&&(v.value=e.data.currency_symbol)}catch(e){console.error("Failed to fetch user configuration:",e)}finally{r.config=!1}},E=e=>(parseFloat(e)/100).toFixed(2),B=e=>{p.value=e,c.value="",d.value=""},N=()=>{if(p.value=null,c.value===""){d.value="";return}const e=parseFloat(c.value);isNaN(e)||e<=0?d.value=a("messages.configLoadFailed")||a("wallet.deposit.amountError.invalid"):e<y?d.value=a("messages.configLoadFailed")||a("wallet.deposit.amountError.minimum").replace("1",y):d.value=""},g=w(()=>p.value?p.value:c.value&&parseFloat(c.value)>=1?parseFloat(c.value):null),k=w(()=>g.value!==null),U=async()=>{r.balance=!0;try{const e=await H();e&&e.data&&(b.value=e.data.balance||0)}catch(e){console.error("Failed to fetch user balance:",e),m(e.response?.message||e.message||a("errors.serverError")||a("common.error_occurred"),"error")}finally{r.balance=!1}},V=async()=>{if(!k.value){m(a("validation.required").replace("{field}",a("wallet.deposit.title"))||a("wallet.deposit.amountError.required"),"warning");return}try{r.submitting=!0;const e=Math.round(g.value*100),n=await Z(e);if(n&&n.data){const i=n.data;m(a("wallet.deposit.success"),"success"),f.push({path:"/payment",query:{trade_no:i,type:"deposit"}})}}catch(e){console.error("Failed to create deposit order:",e),m(e.response?.message||e.message||a("errors.serverError")||a("wallet.deposit.failed"),"error")}finally{r.submitting=!1}};return M(()=>{U(),D()}),(e,n)=>(o(),l("div",x,[s("div",ee,[s("div",se,[s("div",te,[s("h2",oe,t(e.$t("wallet.welcome.title")||"Account Deposit"),1)]),s("div",ae,[s("p",null,t(e.$t("wallet.welcome.description")||"Here you can easily deposit funds into your account, choose preset amounts or enter a custom amount for deposit. Deposited balance will be credited instantly and can be used to purchase our services."),1)])]),s("div",ne,[s("div",le,[s("h2",re,t(e.$t("wallet.balance.title")),1)]),s("div",ie,[r.balance?(o(),l("div",pe,[...n[1]||(n[1]=[s("div",{class:"skeleton-balance-value"},null,-1),s("div",{class:"skeleton-balance-label"},null,-1)])])):(o(),l("div",ce,[s("div",de,t(v.value)+t(E(b.value)),1),s("div",ue,t(e.$t("wallet.balance.description")),1)]))])]),s("div",me,[s("div",ve,[s("h2",_e,t(e.$t("wallet.deposit.title")),1)]),s("div",he,[s("div",fe,[P(A(Q),{size:20,class:"notice-icon"}),s("span",null,t(e.$t("wallet.deposit.notice")),1)]),s("div",be,[s("div",ye,[r.config?(o(),l(C,{key:0},F(4,i=>s("div",{key:`skeleton-${i}`,class:"period-card skeleton-card"},[...n[2]||(n[2]=[s("div",{class:"period-card-inner"},[s("div",{class:"skeleton-price"})],-1)])])),64)):(o(!0),l(C,{key:1},F(I.value,(i,L)=>(o(),l("div",{key:L,class:J(["period-card",{active:p.value===i}]),onClick:Te=>B(i)},[s("div",ke,[s("div",we,[s("span",Ae,t(v.value),1),s("span",Ce,t(i),1)])])],10,ge))),128))])]),s("div",Fe,[s("label",$e,t(e.$t("wallet.deposit.customAmount")),1),r.config?(o(),l("div",Ie,[...n[3]||(n[3]=[s("div",{class:"skeleton-input-field"},null,-1)])])):(o(),l("div",De,[s("span",Ee,t(v.value),1),X(s("input",{id:"customAmount","onUpdate:modelValue":n[0]||(n[0]=i=>c.value=i),type:"number",min:"1",placeholder:e.$t("wallet.deposit.customAmountPlaceholder"),onInput:N},null,40,Be),[[j,c.value]])])),d.value?(o(),l("small",Ne,t(d.value),1)):W("",!0)]),s("div",Ue,[r.config?(o(),l("div",Ve)):(o(),l("button",{key:1,class:"btn-order",disabled:r.submitting||!k.value,onClick:V},[r.submitting?(o(),l("span",qe)):(o(),G(A(K),{key:0,size:18})),s("span",null,t(e.$t("wallet.deposit.button")),1)],8,Le))])])])])]))}},Xe=q(ze,[["__scopeId","data-v-fcf3bcec"]]);export{Xe as default};
