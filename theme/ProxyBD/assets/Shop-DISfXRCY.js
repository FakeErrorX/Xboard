import{Z as X,_ as Q,f as T,w as J,s as ue,z as H,o as a,r as v,B as he,c as l,a as q,v as ye,d as t,e as C,a0 as I,l as V,t as i,$ as me,a6 as fe,a9 as F,p as ve,C as z,az as ge,g as K,h as $,a4 as G,G as we,j as ke,b as R}from"./appInit-CGHXFw0-.js";import{f as Ce,g as be}from"./shop-Cvi7wzfy.js";import{I as U}from"./IconX-CVTrmr_B.js";import{I as Pe}from"./IconBox-DpyC7iFF.js";import{I as Te}from"./IconCheck-B408Qq3X.js";import{I as Ie,a as Se}from"./IconCircle-C-OUj5TY.js";import{I as Me}from"./IconDevices-BdxdBIDS.js";import{I as De}from"./IconRocket-BLunHUmI.js";import"./index-sC8Xq0xY.js";/**
 * @license @tabler/icons-vue v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var He=X("outline","bolt","Bolt",[["path",{d:"M13 3l0 7l6 0l-8 11l0 -7l-6 0l8 -11",key:"svg-0"}]]);/**
 * @license @tabler/icons-vue v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Fe=X("outline","device-tv","DeviceTv",[["path",{d:"M3 7m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v9a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M16 3l-4 4l-4 -4",key:"svg-1"}]]);/**
 * @license @tabler/icons-vue v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var qe=X("outline","info-circle","InfoCircle",[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M12 9h.01",key:"svg-1"}],["path",{d:"M11 12h1v4h1",key:"svg-2"}]]);const Be={name:"ShopPopup",components:{IconX:U},props:{showPopup:{type:Boolean,default:!1},title:{type:String,default:""},content:{type:String,default:""},cooldownHours:{type:Number,default:24},closeWaitSeconds:{type:Number,default:0}},emits:["close"],setup(n,{emit:d}){const m=T(!1),o=T(0);let r=null;const _=()=>{r&&clearInterval(r),n.closeWaitSeconds>0?(o.value=n.closeWaitSeconds,r=setInterval(()=>{o.value>0?o.value-=1:clearInterval(r)},1e3)):o.value=0},u=()=>{if(!(o.value>0)){if(m.value=!1,n.cooldownHours>0){const h=new Date().getTime();localStorage.setItem("shop_popup_close_time",h.toString())}d("close")}};return J(()=>n.showPopup,h=>{h?setTimeout(()=>{if(n.cooldownHours===0){m.value=!0,_();return}const D=localStorage.getItem("shop_popup_close_time");if(D){const B=new Date().getTime()-parseInt(D),g=n.cooldownHours*60*60*1e3;B>=g?(m.value=!0,_()):d("close")}else m.value=!0,_()},500):(m.value=!1,r&&clearInterval(r))},{immediate:!0}),ue(()=>{r&&clearInterval(r)}),{show:m,attemptClose:u,waitTimeRemaining:o}}},Ne={class:"shop-popup-container"},Oe={class:"shop-popup-header"},ze=["innerHTML"],Re={class:"shop-popup-content"},Le=["innerHTML"],Ae={class:"shop-popup-footer"},We=["disabled"];function Je(n,d,m,o,r,_){const u=v("IconX");return a(),H(me,{name:"fade"},{default:he(()=>[o.show?(a(),l("div",{key:0,class:"shop-popup-overlay",onClick:d[2]||(d[2]=ye((...h)=>o.attemptClose&&o.attemptClose(...h),["self"]))},[t("div",Ne,[t("div",Oe,[t("h2",{class:"popup-title",innerHTML:m.title},null,8,ze),t("button",{class:"popup-close-btn",onClick:d[0]||(d[0]=(...h)=>o.attemptClose&&o.attemptClose(...h))},[C(u,{size:20})])]),t("div",Re,[t("div",{innerHTML:m.content},null,8,Le)]),t("div",Ae,[t("button",{class:"popup-action-btn",onClick:d[1]||(d[1]=(...h)=>o.attemptClose&&o.attemptClose(...h)),disabled:o.waitTimeRemaining>0},[o.waitTimeRemaining>0?(a(),l(I,{key:0},[V(i(n.$t("shop.popup.wait_close_btn",{seconds:o.waitTimeRemaining})),1)],64)):(a(),l(I,{key:1},[V(i(n.$t("shop.popup.close_btn")),1)],64))],8,We)])])])):q("",!0)]),_:1})}const Ve=Q(Be,[["render",Je],["__scopeId","data-v-fd9ccbd7"]]),Xe={name:"ShopView",components:{IconRocket:De,IconBolt:He,IconDeviceTv:Fe,IconDevices:Me,IconCheck:Te,IconX:U,IconShoppingCart:fe,IconBox:Pe,IconInfoCircle:qe,IconCircle:Se,IconCircleCheck:Ie,ShopPopup:Ve},setup(){const{t:n,locale:d}=ve(),{showToast:m}=we(),o=ke(),r=z(ge()),_=z({plans:!0,config:!0}),u=T([]),h=T("BDT"),D=T("৳"),y=z({}),B=T([]),g=T("all"),L=T(null),N=[{label:"All",value:"all"},{label:"Recurring",value:"recurring"},{label:"One-time",value:"onetime"}],S=T(!1),b=z({title:"",content:"",cooldownHours:2,closeWaitSeconds:0}),A=()=>{S.value=!1},O=()=>{if(r.popup&&r.popup.enabled){if(b.title=r.popup.title||"",b.content=r.popup.content||"",b.cooldownHours=r.popup.cooldownHours||24,b.closeWaitSeconds=r.popup.closeWaitSeconds||0,b.cooldownHours===0){S.value=!0;return}const e=localStorage.getItem("shop_popup_close_time");if(!e)S.value=!0;else{const p=new Date().getTime()-parseInt(e),w=b.cooldownHours*60*60*1e3;p>=w&&(S.value=!0)}}},c=K(()=>d.value),f=e=>{g.value=e},P=e=>{const s=r.periodOrder||["three_year_price","two_year_price","year_price","half_year_price","quarter_price","month_price","onetime_price"],w=s.filter(k=>k!=="onetime_price").find(k=>e[k]!==null);return w||(e.onetime_price!==null?"onetime_price":s.find(k=>e[k]!==null)||s[0])},j=e=>{const s=W(e);return!s||e[s]===null||e[s]===void 0?"--":(e[s]/100).toFixed(2)};J(()=>g.value,()=>{console.log("Filter changed to:",g.value)}),J(()=>c.value,()=>{console.log("Language changed to:",c.value)}),$(()=>{g.value="all"});const Y=async()=>{_.plans=!0;try{const e=await Ce();e.data&&(u.value=e.data,Object.keys(y).forEach(s=>{delete y[s]}),r.autoSelectMaxPeriod&&G(()=>{u.value.forEach(s=>{const p=r.periodOrder||["three_year_price","two_year_price","year_price","half_year_price","quarter_price","month_price","onetime_price"],k=p.filter(M=>M!=="onetime_price").find(M=>s[M]!==null);k?y[s.id]=k:s.onetime_price!==null?y[s.id]="onetime_price":y[s.id]=p.find(M=>s[M]!==null)||p[0]})}))}catch{m("Failed to fetch plan data","error")}finally{_.plans=!1}},Z=async()=>{_.config=!0;try{const e=await be();e.data&&(h.value=e.data.currency||"BDT",D.value=e.data.currency_symbol||"৳")}catch(e){console.error("Failed to fetch system configuration:",e)}finally{_.config=!1}},E=e=>({month_price:e.month_price,quarter_price:e.quarter_price,half_year_price:e.half_year_price,year_price:e.year_price,two_year_price:e.two_year_price,three_year_price:e.three_year_price,onetime_price:e.onetime_price}),x=e=>({month_price:"month",quarter_price:"quarter",half_year_price:"half_year",year_price:"year",two_year_price:"two_year",three_year_price:"three_year",onetime_price:"onetime"})[e]||"",ee=e=>({month_price:"Monthly",quarter_price:"Quarterly",half_year_price:"Half-year",year_price:"Yearly",two_year_price:"Two-year",three_year_price:"Three-year",onetime_price:"One-time"})[e]||"",te=e=>({month_price:"/ month",quarter_price:"/ quarter",half_year_price:"/ half-year",year_price:"/ year",two_year_price:"/ two years",three_year_price:"/ three years",onetime_price:""})[e]||"",oe=(e,s)=>{y[e]=s},se=e=>{const s=y[e.id];return e[s]===null?"--":(e[s]/100).toFixed(2)},ne=e=>{if(!e)return!1;try{const s=JSON.parse(e);return Array.isArray(s)&&s.length>0&&Object.prototype.hasOwnProperty.call(s[0],"feature")}catch{return!1}},ce=e=>{try{return JSON.parse(e)}catch{return[]}},ie=e=>{if(e.capacity_limit===0){m(n("shop.plan.stock.sold_out"),"error");return}const s=W(e);o.push({path:"order-confirm",query:{id:e.id,period:s}})},ae=K(()=>g.value==="all"?u.value:g.value==="recurring"?u.value.filter(e=>re(e)&&!le(e)):g.value==="onetime"?u.value.filter(e=>e.onetime_price!==null):u.value),re=e=>["month_price","quarter_price","half_year_price","year_price","two_year_price","three_year_price"].some(p=>e[p]!==null),le=e=>{const s=["month_price","quarter_price","half_year_price","year_price","two_year_price","three_year_price"];return e.onetime_price!==null&&!s.some(p=>e[p]!==null)},pe=(e,s)=>{const p=u.value.find(w=>w.id===e);p&&p[s]!==null&&(y[e]=s)},W=e=>{if(y[e.id])return y[e.id];if(r.autoSelectMaxPeriod)return P(e);const s=Object.entries(E(e)).filter(([,p])=>p!==null).map(([p])=>p);return s.length>0?s[0]:""};return $(async()=>{try{_.plans=!0,await Promise.all([Y(),Z()]),_.plans=!1,G(()=>{r.popup&&r.popup.enabled&&r.popup.cooldownHours===0&&localStorage.removeItem("shop_popup_close_time"),O()})}catch(e){console.error("Failed to load data:",e),_.plans=!1}}),{plans:u,loading:_,currency:h,currencySymbol:D,paymentMethods:B,selectedPriceType:y,selectedFilter:g,filteredPlans:ae,getPlanPrices:E,getPriceTypeKey:x,getPriceTypeName:ee,getPeriodText:te,selectPriceType:oe,getSelectedPrice:se,isJsonContent:ne,parseJsonContent:ce,purchasePlan:ie,filterToggle:L,filters:N,setFilter:f,getPlanMainPrice:j,getPlanMainPriceType:P,currentLanguage:c,selectPlanPriceType:pe,getDisplayPriceType:W,showPopup:S,popupConfig:b,handlePopupClose:A,initPopup:O,shopConfig:r,calculateDiscount:e=>{if(!e.month_price)return{showDiscount:!1,periodName:"",discountPercentage:0,savingsAmount:0};const s=e.month_price/100,p=[{type:"three_year_price",price:e.three_year_price?e.three_year_price/100:null,months:36,name:n("shop.plan.price_options.three_year")},{type:"two_year_price",price:e.two_year_price?e.two_year_price/100:null,months:24,name:n("shop.plan.price_options.two_year")},{type:"year_price",price:e.year_price?e.year_price/100:null,months:12,name:n("shop.plan.price_options.year")},{type:"half_year_price",price:e.half_year_price?e.half_year_price/100:null,months:6,name:n("shop.plan.price_options.half_year")},{type:"quarter_price",price:e.quarter_price?e.quarter_price/100:null,months:3,name:n("shop.plan.price_options.quarter")}].filter(_e=>_e.price!==null);if(p.length===0)return{showDiscount:!1,periodName:"",discountPercentage:0,savingsAmount:0};const w=p[0],k=s*w.months,M=(k-w.price)/k*100,de=(k-w.price).toFixed(2);return{showDiscount:M>1,periodName:w.name,discountPercentage:M.toFixed(0),savingsAmount:de}}}}},je={class:"shop-container"},Ee={class:"shop-inner"},Ke={class:"dashboard-card welcome-card"},$e={class:"card-header"},Ge={class:"card-title"},Qe={class:"card-body"},Ue={key:0,class:"stats-grid"},Ye={class:"stats-card animate-card"},Ze={class:"stats-icon"},xe={class:"stats-info"},et={class:"stats-value"},tt={class:"stats-label"},ot={class:"stats-card animate-card"},st={class:"stats-icon"},nt={class:"stats-info"},ct={class:"stats-value"},it={class:"stats-label"},at={class:"stats-card animate-card"},rt={class:"stats-icon"},lt={class:"stats-info"},pt={class:"stats-value"},dt={class:"stats-label"},_t={class:"stats-card animate-card"},ut={class:"stats-icon"},ht={class:"stats-info"},yt={class:"stats-value"},mt={class:"stats-label"},ft={class:"filter-toggle-container"},vt={class:"filter-toggle-wrapper"},gt=["onClick"],wt={class:"option-icon"},kt={class:"option-text"},Ct={class:"plans-wrapper"},bt={key:0,class:"no-plans-message"},Pt={class:"skeleton-card"},Tt={class:"skeleton-body"},It={class:"skeleton-features"},St={class:"card-header"},Mt={class:"card-title"},Dt={key:0,class:"card-badge glassmorphism stock-plenty"},Ht={key:1,class:"card-badge glassmorphism stock-warning"},Ft={key:2,class:"card-badge glassmorphism stock-danger"},qt={class:"card-body"},Bt={class:"plan-price"},Nt={class:"price-display"},Ot={class:"currency"},zt={class:"amount"},Rt={class:"period"},Lt={key:0,class:"supported-periods"},At={class:"period-labels"},Wt=["onClick"],Jt={key:0,class:"discount-calculation"},Vt={class:"discount-info"},Xt={class:"period-name"},jt={class:"discount-label"},Et={class:"discount-value"},Kt={class:"saving-text"},$t={class:"saving-amount"},Gt={class:"plan-features"},Qt=["innerHTML"],Ut=["onClick","disabled"],Yt={class:"btn-text"};function Zt(n,d,m,o,r,_){const u=v("IconRocket"),h=v("IconBolt"),D=v("IconDeviceTv"),y=v("IconDevices"),B=v("IconCircleCheck"),g=v("IconCircle"),L=v("IconInfoCircle"),N=v("IconBox"),S=v("IconCheck"),b=v("IconX"),A=v("IconShoppingCart"),O=v("ShopPopup");return a(),l(I,null,[t("div",je,[t("div",Ee,[t("div",Ke,[t("div",$e,[t("h2",Ge,i(n.$t("shop.title")),1)]),t("div",Qe,[t("p",null,i(n.$t("shop.description")),1)])]),o.shopConfig.showPlanFeatureCards?(a(),l("div",Ue,[t("div",Ye,[t("div",Ze,[C(u,{size:32})]),t("div",xe,[t("div",et,i(n.$t("shop.stats.global_nodes")),1),t("div",tt,i(n.$t("shop.stats.global_nodes_desc")),1)])]),t("div",ot,[t("div",st,[C(h,{size:32})]),t("div",nt,[t("div",ct,i(n.$t("shop.stats.speed")),1),t("div",it,i(n.$t("shop.stats.speed_desc")),1)])]),t("div",at,[t("div",rt,[C(D,{size:32})]),t("div",lt,[t("div",pt,i(n.$t("shop.stats.streaming")),1),t("div",dt,i(n.$t("shop.stats.streaming_desc")),1)])]),t("div",_t,[t("div",ut,[C(y,{size:32})]),t("div",ht,[t("div",yt,i(n.$t("shop.stats.devices")),1),t("div",mt,i(n.$t("shop.stats.devices_desc")),1)])])])):q("",!0),t("div",ft,[t("div",vt,[(a(!0),l(I,null,F(o.filters,c=>(a(),l("div",{key:`${c.value}-${o.currentLanguage}`,class:R(["filter-option",{active:o.selectedFilter===c.value}]),onClick:f=>o.setFilter(c.value)},[t("div",wt,[o.selectedFilter===c.value?(a(),H(B,{key:0})):(a(),H(g,{key:1}))]),t("span",kt,i(n.$t(`shop.filter.${c.value}`)),1)],10,gt))),128))])]),t("div",Ct,[!o.loading.plans&&o.filteredPlans.length===0?(a(),l("div",bt,[C(L,{size:48,class:"info-icon"}),t("h3",null,i(n.$t("shop.no_plans_found")),1),t("p",null,i(n.$t("shop.try_different_filter")),1),t("button",{class:"btn-reset-filter",onClick:d[0]||(d[0]=c=>o.selectedFilter="all")},i(n.$t("shop.reset_filter")),1)])):o.loading.plans?(a(),l(I,{key:1},F(3,c=>t("div",{class:"dashboard-card",key:"skeleton-"+c},[t("div",Pt,[d[3]||(d[3]=t("div",{class:"skeleton-header"},null,-1)),t("div",Tt,[d[1]||(d[1]=t("div",{class:"skeleton-price"},null,-1)),t("div",It,[(a(),l(I,null,F(5,f=>t("div",{class:"skeleton-feature",key:"feature-"+f})),64))]),d[2]||(d[2]=t("div",{class:"skeleton-button"},null,-1))])])])),64)):(a(!0),l(I,{key:2},F(o.filteredPlans,c=>(a(),l("div",{class:"plan-card",key:c.id},[t("div",St,[t("h2",Mt,i(c.name),1),c.capacity_limit>=o.shopConfig.lowStockThreshold||c.capacity_limit===null?(a(),l("div",Dt,[C(N,{size:16,class:"badge-icon"}),t("span",null,i(n.$t("shop.plan.stock.plenty")),1)])):c.capacity_limit>0&&c.capacity_limit<o.shopConfig.lowStockThreshold?(a(),l("div",Ht,[C(N,{size:16,class:"badge-icon"}),t("span",null,i(n.$t("shop.plan.stock.warning")),1)])):q("",!0),c.capacity_limit===0?(a(),l("div",Ft,[C(N,{size:16,class:"badge-icon"}),t("span",null,i(n.$t("shop.plan.stock.sold_out")),1)])):q("",!0)]),t("div",qt,[t("div",Bt,[t("div",Nt,[t("span",Ot,i(o.currencySymbol),1),t("span",zt,i(o.getPlanMainPrice(c)),1),t("span",Rt,i(n.$t(`shop.plan.periods.${o.getPriceTypeKey(o.getDisplayPriceType(c))}`)),1)]),o.shopConfig.hidePeriodTabs?q("",!0):(a(),l("div",Lt,[t("div",At,[(a(!0),l(I,null,F(o.getPlanPrices(c),(f,P)=>(a(),l("span",{key:P,class:R(["period-tag",{active:o.getDisplayPriceType(c)===P,disabled:f===null}]),onClick:j=>f!==null&&o.selectPlanPriceType(c.id,P)},[f!==null?(a(),H(S,{key:0,class:"tag-icon check"})):(a(),H(b,{key:1,class:"tag-icon error"})),V(" "+i(n.$t(`shop.plan.price_options.${o.getPriceTypeKey(P)}`)),1)],10,Wt))),128))])]))]),o.shopConfig.enableDiscountCalculation&&o.calculateDiscount(c).showDiscount?(a(),l("div",Jt,[t("div",Vt,[t("span",Xt,i(o.calculateDiscount(c).periodName),1),t("span",jt," "+i(n.$t("shop.plan.discount.relative")),1),t("span",Et," "+i(o.calculateDiscount(c).discountPercentage)+"%",1),t("span",Kt,", "+i(n.$t("shop.plan.discount.savings")),1),t("span",$t," "+i(o.currencySymbol)+i(o.calculateDiscount(c).savingsAmount),1)])])):q("",!0),t("div",Gt,[o.isJsonContent(c.content)?(a(!0),l(I,{key:0},F(o.parseJsonContent(c.content),(f,P)=>(a(),l("div",{class:"feature-item",key:P},[f.support?(a(),H(S,{key:0,class:"feature-icon enabled"})):(a(),H(b,{key:1,class:"feature-icon disabled"})),t("span",{class:R({"disabled-text":!f.support})},i(f.feature),3)]))),128)):(a(),l("div",{key:1,class:"html-content",innerHTML:c.content},null,8,Qt))]),t("button",{class:R(["btn-purchase glassmorphism",{"btn-disabled":c.capacity_limit===0}]),onClick:f=>o.purchasePlan(c),disabled:c.capacity_limit===0},[C(A,{class:"btn-icon"}),t("span",Yt,i(c.capacity_limit===0?n.$t("shop.plan.sold_out_btn"):n.$t("shop.plan.purchase")),1)],10,Ut)])]))),128))])])]),C(O,{"show-popup":o.showPopup,title:o.popupConfig.title,content:o.popupConfig.content,"cooldown-hours":o.popupConfig.cooldownHours,"close-wait-seconds":o.popupConfig.closeWaitSeconds,onClose:o.handlePopupClose},null,8,["show-popup","title","content","cooldown-hours","close-wait-seconds","onClose"])],64)}const lo=Q(Xe,[["render",Zt],["__scopeId","data-v-0f02f99c"]]);export{lo as default};
