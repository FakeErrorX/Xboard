import{G as d,p as P,V as f,W as y,X as w,Y as g,j as v}from"./appInit-CGHXFw0-.js";const t={verifyToken:null,redirectPath:null,originalUrl:""};(function(){try{t.originalUrl=window.location.href;const s=window.location.hash||"";if(s.includes("?")){const e=s.split("?")[1];if(e){const a=new URLSearchParams(e);t.verifyToken=a.get("verify"),t.redirectPath=a.get("redirect")}}if(!t.verifyToken){const e=new URLSearchParams(window.location.search);t.verifyToken=e.get("verify"),t.redirectPath=e.get("redirect")}}catch{}})();const T=async(i={})=>{const s=v(),{showToast:e}=d(),{t:a}=P();let n=t.verifyToken,o=t.redirectPath;if(!n){let r=window.location.hash,c=new URLSearchParams;r.includes("?")&&(c=new URLSearchParams(r.split("?")[1]||""));const h=r.split("/"),l=h[h.length-1];if(l&&l.includes("?")&&(c=new URLSearchParams(l.split("?")[1]||"")),n=c.get("verify"),o=c.get("redirect"),!n){const u=new URLSearchParams(window.location.search);n=u.get("verify"),o=u.get("redirect")}}if(o=o||"/dashboard",!n)return{success:!1,verified:!1};f.start();try{const r=await y(n,o);if(r.data&&(r.data.token||r.data.auth_data)){e(r.message||a("auth.verifyTokenSuccess"),"success"),w(r.data,!1).success;const h=g(o);return i.onLoginSuccess&&typeof i.onLoginSuccess=="function"&&i.onLoginSuccess(),setTimeout(()=>{s.push(h)},500),{success:!0,verified:!0,redirectPath:h}}else return e(a("auth.verifyTokenFailed"),"error"),{success:!1,verified:!0,error:a("auth.verifyTokenFailed")}}catch{return e(a("auth.verifyTokenFailed"),"error"),{success:!1,verified:!0,error:a("auth.verifyTokenFailed")}}finally{f.done()}},k=()=>{if(t.verifyToken)return!0;let i=window.location.hash,s=new URLSearchParams;i.includes("?")&&(s=new URLSearchParams(i.split("?")[1]||""));const e=i.split("/"),a=e[e.length-1];a&&a.includes("?")&&(s=new URLSearchParams(a.split("?")[1]||""));const n=new URLSearchParams(window.location.search);return s.has("verify")||n.has("verify")||!!t.verifyToken};export{T as a,k as h};
